###############################################################################
# Alias options {{{

  set alias_file=~/.mutt/aliases
source ~/.mutt/aliases
source ~/.mutt/lists

# }}}
###############################################################################
# Server/Folder options {{{

source ~/.mutt/smtp-majutsushi.net
# source ~/.mutt/imap-urd
# source ~/.mutt/imap-majutsushi.net
source ~/.mutt/maildir

# to set:
#   set smtp_url=""
#   set smtp_pass=""
#   set folder=
#   set spoolfile=
#   set imap_user=
#   set imap_pass=""

  set postponed="=.postponed"
  set record="=.sent"
  set imap_idle
  set imap_authenticators=""
  set imap_check_subscribed
  set imap_delim_chars="/."
  set imap_keepalive=900
  set imap_list_subscribed
  set imap_passive
  set imap_peek
  set imap_servernoise

  set certificate_file="~/.mutt/certificates"
  set connect_timeout=30
#  set entropy_file=""
  set header_cache="~/.cache/mutt_header/"
#  set header_cache_pagesize=16384
  set maildir_header_cache_verify=yes
#  set message_cachedir="~/.cache/mutt_body/" # body caching
unset keep_flagged
  set mbox_type=Maildir
  set preconnect=""
  set sendmail="/usr/sbin/sendmail -oem -oi"
  set sendmail_wait=0
  set ssl_ca_certificates_file=/etc/ssl/certs/ca-certificates.crt
  set ssl_force_tls
  set ssl_starttls
#  set ssl_use_sslv2
  set ssl_use_sslv3
  set ssl_use_tlsv1
#  set ssl_usesystemcerts
  set tmpdir="/tmp"
  set tunnel=""
  set use_ipv6

# }}}
###############################################################################
# Identity options {{{

unset use_envelope_from
  set from="jan@majutsushi.net"           # takes value from $EMAIL
  set hostname="majutsushi.net"
  set realname="Jan Larres"
  set use_from          # generate a "From:" header (unless my_hdr From:)

# alternative mail addresses
alternates (((jan(\.larres)?)|lists|majutsushi).*@majutsushi.net|jan.larres@gmail.com|jan.larres@gmx.net|larres(01)?@[a-z.]*uni-passau.de)

# }}}
###############################################################################
# Security options {{{

  set crypt_autosign    # see folder-hooks
unset crypt_autoencrypt
  set crypt_replyencrypt
  set crypt_replysign
  set crypt_replysignencrypted
  set crypt_timestamp
  set crypt_verify_sig
unset forward_decrypt   # decrypt PGP message, when mime_forward and !mime_fw_d

# =============================================================================
# PGP {{{
unset pgp_autoinline  # attempt to send as inline
  set pgp_entry_format="%4n %t%f %4l/0x%k %-4a %2c %u"
  set pgp_ignore_subkeys
unset pgp_long_ids
unset pgp_replyinline # reply to inline as inline
unset pgp_retainable_sigs
  set pgp_show_unusable # Show non-usable keys on the PGP key selection menu?
  set pgp_sign_as="00A0FD5F"
  set pgp_strict_enc
  set pgp_sort_keys=address
  set pgp_timeout=1000  # number of seconds to cache passphrase
unset pgp_use_gpg_agent
  set pgp_auto_decode
# }}}
# =============================================================================
# S/MIME {{{

unset smime_is_default
  set smime_timeout=1000
  set smime_ask_cert_label
  set smime_encrypt_with=""

  # Section A: Key Management

  set smime_default_key=""
  set smime_decrypt_use_default_key
  set smime_ca_location="~/.smime/ca-bundle.crt"
#   set smime_ca_location="/etc/ssl/certs/ca-certificates.crt"
#   set smime_ca_location="~/.smime/ca-certificates/"
  set smime_certificates="~/.smime/certificates"
  set smime_keys="~/.smime/keys"
  # These are used to extract a certificate from a message.
  # First generate a PKCS#7 structure from the message.
  set smime_pk7out_command="openssl smime -verify -in %f -noverify -pk7out"
  # Extract the included certificate(s) from a PKCS#7 structure.
  set smime_get_cert_command="openssl pkcs7 -print_certs -in %f"
  # Extract the signer's certificate only from a S/MIME signature (sender verification)
  set smime_get_signer_cert_command="openssl smime -verify -in %f -noverify -signer %c -out /dev/null"
  # This is used to get the email address the certificate was issued to.
  set smime_get_cert_email_command="openssl x509 -in  %f -noout -email"
  # Add a certificate to the database using smime_keysng.
  set smime_import_cert_command="smime_keysng add_cert %f"

  # Section B: Outgoing messages

  # Algorithm to use for encryption.
  # valid choices are rc2-40, rc2-64, rc2-128, des, des3
  set smime_encrypt_with="des3"
  # Encrypt a message. Input file is a MIME entity.
  set smime_encrypt_command="openssl smime -encrypt -%a -outform DER -in %f %c"
  # Sign.
  set smime_sign_command="openssl smime -sign -signer %c -inkey %k -passin stdin -in %f -certfile %i -outform DER"

  # Section C: Incoming messages

  # Decrypt a message. Output is a MIME entity.
  set smime_decrypt_command="openssl smime -decrypt  -passin stdin -inform DER -in %f -inkey %k -recip %c"
  # Verify a signature of type multipart/signed
  set smime_verify_command="openssl smime -verify -inform DER -in %s %C -content %f"
  # Verify a signature of type application/x-pkcs7-mime
  set smime_verify_opaque_command="openssl smime -verify -inform DER -in %s %C"

# }}}
# =============================================================================

# }}}
###############################################################################
# Message compositing options {{{

# =============================================================================
# before editing {{{

  set abort_nosubject=no     # Abort, if message has no subject.
unset askbcc            # ask to fill out Bcc on mesg-send?
unset askcc             # ask to fill out CC on mesg-send?
unset autoedit          # start editor without asking for to, subject,...
  set editor="~/bin/runhtag"
#   set editor="vim '+:5'"
#   set editor="vim '+/^$'"
  set edit_headers      # put headers in editor when composing messages
  set followup_to       # Add Mail-Followup-To header.
  set hdrs              # nohdrs implies not to write my_hdr into mail.
unset hidden_host       # when set, skip the host name part of hostname
  set indent_string="> "   # change this and I'll kill you!  ;-)
#   set query_command="abook --mutt-query '%s'"
#   set query_command="~/bin/mutt-evo-query.rb '%s'"
  set query_command="lbdbq '%s'"
  set recall=ask-no     # ask for using postponed message.
unset sig_dashes        # Don't prepend "-- \n" to the signature
unset sig_on_top
  set signature=""
unset text_flowed
unset use_domain        # add $hostname to all addresses without @host
  set user_agent        # Create User-Agent: Mutt/<Version> header.

# }}}
# =============================================================================
# after editing {{{

  set abort_unmodified=yes   # Abort, if message wasn't edited.
  set allow_8bit        # use QP or Base64 if unset.
  set compose_format="-- Mutt: Compose [Approx. msg size: %l Atts: %a]%>-"
  set content_type="text/plain"
  set copy              # always keep a copy of my mails
  set encode_from       # use Quoted-Printable, if '^From ' in a mail.
  set fcc_attach        # store attachments too when doing a Fcc
  set fcc_clear         # FCCs will be stored unencrypted and unsigned
unset force_name        # outgoing mail to be saved in folder of "login name"
  set ispell="aspell -e -c"
  set postpone=ask-no   # ask for postponing when doing an Abort.
unset save_name         # Fcc, if ~/Mail/<to> exists.
#   set send_charset="us-ascii:iso-8859-1:iso-8859-15:iso-2022-jp:utf-8"
  set send_charset="us-ascii:iso-8859-15:utf-8"
  set use_8bitmime      # run sendmail 8.8.x with -B8BITMIME to enable 8bit
unset write_bcc         # send Bcc: line to $sendmail

# }}}
# =============================================================================
# replying {{{

  set attribution="%n <%a>:"
  set fast_reply        # ignored if $autoedit
unset header            # quote full header on reply
  set honor_followup_to=yes   # Ask whether to honor Mail-Followup-To header
  set ignore_list_reply_to    # ignore Reply-To pointing back to mailinglist
  set include=yes       # quote message, when replying
unset metoo             # should we keep ourselves in group replies?
  set post_indent_string=""
unset reply_self        # if unset, a reply to yourself implies reply to other
  set reply_to=ask-yes  # Use or ignore Reply-To.
unset reverse_name      # Set "From" to address, where replied mail was sent to
  set reverse_realname  # if unset, use $realname in $reverse_name

# }}}
# =============================================================================
# forwarding {{{

  set bounce="ask-yes"
unset bounce_delivered  # unset => remove Delivered-To: when bouncing.
  set forward_decode    # decode messages when forwarding without MIME
  set forward_edit=yes
  set forward_format="Fw: [%a: %s]"
  set forward_quote     # quote forwarded message, if not $mime_forward
  set mime_forward=ask-yes    # use MIME when forwarding mails.
unset mime_forward_decode     # decode messages when forwarding with MIME
  set mime_forward_rest=yes

# }}}
# =============================================================================

# }}}
###############################################################################
# Interface options {{{

# =============================================================================
# general {{{

unset arrow_cursor      # "->" as cursor (faster on slow networks).
  set beep              # beep on certain user errors and other errors
unset beep_new          # beep on new mail
#  set charset="iso-8859-15"
  set charset="utf-8"
  set check_new         # search for new messages in maildir/MH folders.
  set escape="~"
  set help              # show help in first line of the display
  set history=50
  set locale="de_DE"
  set mail_check=5
  set menu_scroll       # scroll on last line of menu (set) or do a nextpage?
unset meta_key          # Don't interpret Alt-x as ESC x
  set move=no           # Move mail-spool to $mbox?
  set quit=yes          # ask before quitting.
unset read_only         # folders not read only
unset score             # don't do scoring
  set sleep_time=1
  set status_on_top     # status line at the top or button?
unset suspend           # Ctrl-Z is able to suspend mutt.
unset wait_key          # Only "press a key" if return value non-zero
  set xterm_icon="M%?n?AIL&ail?"
  set xterm_set_titles
  set xterm_title="Mutt with %?m?%m messages&no messages?%?n? [%n NEW]?"

# }}}
# =============================================================================
# browser {{{

  set folder_format="%F %d %8s %2N %f"
#  set mask="!^\.[^.]"   # doesn't work for some reason ...
  set sort_browser=alpha

# }}}
# =============================================================================
# index {{{

# threads
unset collapse_unread   # collapse threads with unread mails
unset digest_collapse
  set duplicate_threads
unset strict_threads    # thread only by In-Reply-To/References.
  set reply_regexp="^((Re|RE|re|Aw|AW|aw) ?:[ \t]*)*"
  set sort_re           # only put a child in a thread if starts with 'reply_regexp'
unset thread_received   # use date received instead of date sent for thread subject sort
unset uncollapse_jump   # don't move pointer when uncollapsing thread

unset ascii_chars       # Use ASCII chars for threading arrows.
  set auto_tag          # if something is tagged, run commands on tagged msgs.
unset confirmappend     # prompt for confirm when appending message to ex. mbox
  set confirmcreate     # prompt for confirm when saving to non existing mbox
  set date_format="!%a, %d %b %Y %H:%M:%S %z"
  set delete=yes        # ask for confirmation when deleting messages?
  set delete_untag      # untag messages when marking them for deletion.
#   set index_format="%4C %?H?%-12.12H&%Z %[%d/%m/%y]? %-17.17F %?M?(#%03M)&(%4c)? %s"
  set index_format="%4C %Z %[%d/%m/%y] %[%H:%M] %-20.20F %?M?%3M&   ? %?Y?[%Y] ?%s%*  %c"
unset mark_old          # mark new articles as old, when leaving mbox
  set mh_purge          # remove messages marked as deleted from MH folders.
  set narrow_tree
  set read_inc=20
unset resolve           # go to next undeleted message after modifying actual
unset reverse_alias     # use realname from reverse alias lookup
  set status_chars="-*%A" # status of mbox (unchanged, changed, readonly, attach)
  set status_format="-%r-Mutt: %f [Msgs:%?M?%M/?%m%?n? New:%n?%?o? Old:%o?%?d? Del:%d?%?F? Flag:%F?%?t? Tag:%t?%?p? Post:%p?%?b? Inc:%b?%?l? %l?]---(%s/%S)-%>-(%P)---"
  set to_chars=" +TCFL" # default (Not to me, To me, CC me, From me)
  set write_inc=10      # number - display increment count for every n-th mail

# }}}
# =============================================================================
# pager {{{

unset allow_ansi
  set display_filter='t-prot -cmekatl --max-lines=250 --bigq --pgp-move-vrf -Mmutt -L$XDG_CONFIG_HOME/t-prot/footers -A$XDG_CONFIG_HOME/t-prot/ads'
unset implicit_autoview # use autoview, if a "copiousoutput" is in mailcap.
#  set mailcap_path=""
  set mailcap_sanitize  # remove ugly chars from mailcap % expands.
  set markers           # put a '+' at the beginning of wrapped lines.
  set pager="builtin"
  set pager_context=3
  set pager_format="%S [%C] %-20.20n (%l/%P) %s"
#   set pager_index_lines=9   # number of lines to see from the index
  set pager_index_lines=15   # number of lines to see from the index
  set pager_stop        # Don't jump to next message at end of message.
unset prompt_after      # display prompt after exit from pager
#   set quote_regexp="^( {0,4}-?[>|:%]| {0,4}[a-z0-9]+[>|]+)+"
  set quote_regexp="^( {0,4}-?[>|]| {0,4}[a-z0-9]+[>|]+)+"
  set smart_wrap        # wrap long lines at word boundary.
  set smileys="(>From )|(:[-^]?[][)(><}{|/DP])"
  set tilde             # Internal Pager: ~~~~ at and of message?
  set wrapmargin=0

auto_view text/html text/enriched application/x-gunzip application/postscript application/x-tar-gz application/pgp-signature #image/*

# Headers to ignore/see
# Ignore everything but the really important lines:
ignore *
unignore from: date subject to cc reply-to:
unignore organization organisation
unignore user-agent: x-agent: x-mailer: x-newsreader:
unignore newsgroups: posted-to: X-Spam-Status:
unignore X-Fnord: X-Message-Flag:
unignore x-label:

# ordering of headers in the pager
unhdr_order *
hdr_order Date: From: Reply-To: To: Cc: Subject: X-Label: X-Newsreader: X-Mailer: Organization: Organisation: User-Agent: X-Fnord: X-Message-Flag: Newsgroups: X-Spam-Status:

# this is cool, dual text/html mails have only the text part shown
alternative_order text/plain text/html  # I like plaintext more than html.

# }}}
# =============================================================================
# sidebar {{{

#   set sidebar_boundary="._-"
# unset sidebar_newmail_only
# unset sidebar_shorten_hierarchy
  set sidebar_sort
  set sidebar_shortpath
  set sidebar_visible
  set sidebar_width=40

# }}}
# =============================================================================
# attachments {{{

  set attach_format="%u%D%I %t%4n %T%.40d%> [%.7m/%.10M, %.6e%?C?, %C?, %s] "

# }}}
# =============================================================================
# aliases {{{

  set alias_format="%4n %2f %t %-10a %r"
  set sort_alias=alias

# }}}
# =============================================================================

# }}}
###############################################################################
# Printing {{{

  set print=yes          # ask whether you really want to print.
  set print_command="muttprint"
  set print_decode
  set print_split

# }}}
###############################################################################
# Spam {{{

# spam "X-Spam-Status: Yes, score=([0-9]+.[0-9]+)" "Spam [%1]"

# }}}
###############################################################################
# External options {{{

  set attach_sep="\n"
  set attach_split      # handle every single attachment instead of concat
unset pipe_decode       # Weed headers and PGP-decode message before piping
  set pipe_split        # split tagged messages (or don't) when using "|"
  set rfc2047_parameters
unset save_address      # Use full mail adress (with domain) as default folder.
unset save_empty        # remove mailbox when last message is removed.
  set shell=""

# }}}
###############################################################################
# Searching {{{

  set default_hook="~f %s | ~t %s"
  set simple_search="~f %s | ~C %s | ~s %s"   # default pattern (Fr|To|Cc|Su)
unset thorough_search   # MIME decode before searching.
  set wrap_search       # Wrap search to top/bottom.

# }}}
###############################################################################
# Bindings {{{

# =============================================================================
# General {{{

# Bindings for editing and reloading the .muttrc
#macro generic   ,ve   "!screen -t muttrc vi ~/.muttrc\r"
macro generic   ,vu   ":source ~/.muttrc\r" "Source muttrc"
#macro generic   ,va   "!screen -t aliases vi ~/.mutt/aliases\r"

macro index,pager i   "<sync-mailbox><change-folder>?<toggle-mailboxes>" "Go to mailbox list"
bind browser i        exit

# toggle TOFU protection with ESC-0 (off) and ESC-1 (on)
macro generic \e0 ":unset display_filter\n" "Turn TOFU protection off"
macro generic \e1 ":set display_filter='t-prot -cmekatl --max-lines=250 --bigq --pgp-move-vrf -Mmutt -L$XDG_CONFIG_HOME/t-prot/footers -A$XDG_CONFIG_HOME/t-prot/ads'\n" "Turn TOFU protection on"

# }}}
# =============================================================================
# browser {{{

bind browser x          check-new

# }}}
# =============================================================================
# index & pager {{{

# movement
bind index  ' '         next-unread
bind index   <pagedown> next-page
bind index   <pageup>   previous-page
bind pager   j          next-line
bind pager   k          previous-line
bind pager   p          previous-undeleted
bind pager   n          next-undeleted
bind pager  ' '         next-unread
bind pager   \n         next-new
bind pager   <up>       previous-line
bind pager   <down>     next-line

# syncing
bind index   x          sync-mailbox
bind index   X          imap-fetch-mail
bind pager   X          imap-fetch-mail

# deleting
macro index  d          "<delete-message><next-undeleted>"
macro pager  d          "<delete-message><next-undeleted>"

# printing
macro index '\p'        "<display-toggle-weed> <print-message> <display-toggle-weed> <exit>"
macro pager '\p'        "<display-toggle-weed> <print-message> <display-toggle-weed>"

# threads
macro index  \CR        "<read-thread><collapse-thread><next-unread><current-middle>" "Mark the current thread as read"
macro pager  \CR        "<read-thread><collapse-thread><next-unread><display-message>" "Mark the current thread as read"
macro index '{'         "<collapse-thread>"

# quickly change to important folders
macro index  I          "c!\n" "Go to Inbox"
macro pager  I          "c!\n" "Go to Inbox"
macro index  ,S         "c<\n" "Go to 'sent' folder"
macro pager  ,S         "c<\n" "Go to 'sent' folder"
macro index  ,A         "c=.archive\n" "Go to 'archive' folder"
macro pager  ,A         "c=.archive\n" "Go to 'archive' folder"
macro index  ,W         "c=.0WAITING\n" "Go to 'waiting' folder"
macro pager  ,W         "c=.0WAITING\n" "Go to 'waiting' folder"
macro index  ,F         "c=.0FOLLOWUP\n" "Go to 'followup' folder"
macro pager  ,F         "c=.0FOLLOWUP\n" "Go to 'followup' folder"

# quickly file mail
macro index  ,a         "<save-message>=.archive\n<next-unread>" "Move message to folder 'archive'"
macro pager  ,a         "<save-message>=.archive\n<next-unread>" "Move message to folder 'archive'"
macro index  ,w         "<save-message>=.0WAITING\n<next-unread>" "Move message to folder '0WAITING'"
macro pager  ,w         "<save-message>=.0WAITING\n<next-unread>" "Move message to folder '0WAITING'"
macro index  ,f         "<save-message>=.0FOLLOWUP\n<next-unread>" "Move message to folder '0FOLLOWUP'"
macro pager  ,f         "<save-message>=.0FOLLOWUP\n<next-unread>" "Move message to folder '0FOLLOWUP'"
macro index  ,p         "<pipe-message>procmail\n<delete-message><next-unread>" "Pipe message through procmail"
macro pager  ,p         "<pipe-message>procmail\n<delete-message><next-unread>" "Pipe message through procmail"

# search mail with maildir-utils
macro index  ,mf        "<shell-escape>mu find --clearlinks --linksdir=~/.mu/results " "mu find"
macro index  ,mr        "<change-folder-readonly>~/.mu/results\n" "display mu find results"

macro index  \eR        "|~/bin/remember-mail\n"

# X-Label patch
ifdef edit-label bind index,pager y edit-label

# spam handlers
macro index  S          "|/usr/bin/sa-learn --spam --no-sync --single\r" "Classify as Spam"
macro index  H          "|/usr/bin/sa-learn --ham  --no-sync --single\r" "Classify as Ham"
macro index  P          "!/usr/bin/sa-learn --sync\r" "Sync Spamassassin-db"

# limit mails
macro index  ,la        "l~A\n<collapse-all>" "Limit to all messages"
macro index  ,ll        "l~F | ~O | ~N\n" "Limit to new, old and flagged messages"

# abook
#macro index  A          |'abook --add-email'\n
#macro pager  A          |'abook --add-email'\n
#macro index  B          "!abook"
#macro pager  B          "!abook"

# gpg
macro pager  J          "!gpg --keyserver search.keyserver.net --keyserver-options honor-http-proxy --recv-key " "Get PGP Key"
macro pager  K          "!gpg --lsign-key " "Sign PGP Key"

# same in pager mode - ugly but what the hell...
macro pager \e0         ":unset display_filter; exec exit\n:exec display-message\n" "Turn TOFU protection off"
macro pager \e1         ":set display_filter='t-prot -cmekatl --max-lines=250 --bigq --pgp-move-vrf -Mmutt -L$XDG_CONFIG_HOME/t-prot/footers -A$XDG_CONFIG_HOME/t-prot/ads'; exec exit\n:exec display-message\n" "Turn TOFU protection on"

# }}}
# =============================================================================
# compose {{{

bind compose   <enter>  send-message
bind compose   <return> send-message
bind compose   v   view-attach

macro compose \es "Fgpg --clearsign\ny" "clearsign with GnuPG"
macro compose \ee "Fgpg --encrypt --armor\ny" "encrypt with GnuPG"
#macro pager \eD "|gpg --decrypt | less\n" "decrypt with GnuPG"
#macro index \eD "|gpg --decrypt | less\n" "decrypt with GnuPG"
#macro pager \eV "|gpg --verify\n" "verify signature with GnuPG"
#macro index \eV "|gpg --verify\n" "verify signature with GnuPG"

# }}}
# =============================================================================
# attach {{{

bind attach ' ' select-entry

# }}}
# =============================================================================
# editor {{{

# bind editor <tab>       complete-query # overwrites <complete>

# }}}
# =============================================================================
# sidebar {{{

bind index \Cp sidebar-prev
bind index \Cn sidebar-next
bind index \Co sidebar-open
bind pager \Cp sidebar-prev
bind pager \Cn sidebar-next
bind pager \Co sidebar-open

macro index   B ':toggle sidebar_visible'
macro pager   B ':toggle sidebar_visible'
macro compose B ':toggle sidebar_visible'

# }}}
# =============================================================================
# query menu {{{

bind query <space> tag-entry
# bind query T       tag-pattern

# }}}
# =============================================================================

# }}}
###############################################################################
# Colors {{{

# source `case $TERM in\
#              *256color) echo '~/.mutt/colors256-dark'; break ;;\
#              *)        echo '~/.mutt/konsole-color'; break ;;\
#         esac`

# =============================================================================
# general {{{

color normal    white      default  # normal message text
color status    white      blue     # status lines
color indicator black      yellow   # current line in index etc
color message   white      blue     # info messages
color error     red        default

# color sidebar     white    default
color sidebar_new red      default

# }}}
# =============================================================================
# index {{{

# color index     white    default  '~p'    # mail to myself
# color index     green          default  '! ~p'  # mail not to myself
color index     green    default  '~N !~D'    # new undeleted mail
# color index     brightyellow default '~N ~p'
# color index     green    default  '!~N'    # read mail
color index     cyan     default  '(~P !~D) | (~v ~(~P !~D))'    # mail from myself

color index     brightblack    default     "=s '*****SPAM*****'"
color index     brightblack    default     "=s '*** GMX Spamverdacht ***'"
# color index     brightblack    default     "~h '^X-Spam-Status:.*score=[34].'"
# color index     brightred      default     "~h '^X-Spam-Status:.*score=[56].'"

color index     red            default  '(~F !~D) | (~v ~(~F !~D))'  # Flagged
color index     blue           default  ~T      # Tagged
color index     magenta        default  ~D      # Deleted
# color index brightblack default '~d>1w'

color tree      brightmagenta  default  # thread arrows

# }}}
# =============================================================================
# message headers {{{

color hdrdefault cyan       default
color header     yellow     default  "^from"
color header     green      default  "^from:"
color header     green      default  "^reply-to:"
color header     green      default  "^to:"
color header     green      default  "^cc:"
color header     green      default  "^date:"
color header     yellow     default  "^newsgroups:"
color header     brightcyan default  "^subject:"
color header     red        default  "^x-spam-rule:"
color header     yellow     default  "^x-mailer:"
color header     yellow     default  "^message-id:"
color header     yellow     default  "^Organization:"
color header     yellow     default  "^Organisation:"
color header     yellow     default  "^User-Agent:"
color header     yellow     default  "^X-Message-Flag:"
color header     yellow     default  "^X-Spam-Status:"
color header     yellow     default  "^X-SpamProbe:"
color header     red        default  "^X-SpamProbe: SPAM"

# }}}
# =============================================================================
# message bodies {{{

color body      yellow      default  " [;:]-?[)/(|]"  # colorise smileys
# color body      brightblue  default  "\\b[^ ]+://[^] >\")]*"
color body      brightblue  default  "((ftp|http|https)://|(file|news):|www\\.)[-a-z0-9_.:]*[a-z0-9](/[^][{} \t\n\r\"<>()]*[^][{} \t\n\r\"<>().,:!])?/?"
# color body      brightblue  default  "(http|https|ftp|news|telnet|finger)://[^ ]*"
# color body      cyan        default  "ftp://[^ ]*"
color body      brightgreen default  "[[:alnum:]][-+.#_[:alnum:]]*@[-+.[:alnum:]]*[[:alnum:]]"
color body      cyan        default  "<URL:[^ ]*>"

#  Coloring quoted text - coloring the first 8 levels:
color quoted    cyan        default
color quoted1   yellow      default
color quoted2   red         default
color quoted3   green       default
color quoted4   cyan        default
color quoted5   yellow      default
color quoted6   red         default
color quoted7   green       default

# diffs
color body brightred default "^-(--)?[^-].*"
color body brightgreen default "^[+].*"
color body brightblue default "^!.*"
color body brightwhite default "^diff .*"
color body brightwhite default "^index [a-f0-9].*"
color body brightyellow default "^@@ .*"

color attachment white      magenta
color signature brightred   default
color tilde     blue        default
color markers   red         default  # wrap markers
# color bold      green       default
# color underline yellow      default

# highlight TOFU protection:
color body	brightmagenta		black	"^\\[---.*"
color body	green			black	"^#v[-+]"

# }}}
# =============================================================================

# }}}
###############################################################################
# Hooks {{{

#save-hook .* =INBOX.lists.%B

charset-hook us-ascii ISO-8859-15
charset-hook unknown-8bit ISO-8859-15

folder-hook .            set timeout=30
# folder-hook .            set sort=date
folder-hook .            set sort=threads sort_aux=date-sent
# folder-hook .            'push ":unset collapse_unread<enter><collapse-all>:set collapse_unread<enter>"'
folder-hook .            'push "<collapse-all>"'
#folder-hook .            set sort_aux=date-sent
folder-hook .            set mail_check=90
folder-hook .            set crypt_autosign
#folder-hook .            save-hook .* >.
folder-hook .            unmy_hdr *
folder-hook .            my_hdr From: Jan Larres <jan@majutsushi.net>
folder-hook .            my_hdr X-Editor: Vim http://www.vim.org/
folder-hook .            my_hdr X-Operating-System: `uname -s`/`uname -r` (`uname -m`)
#folder-hook .            my_hdr X-Uptime: \`uptime\`
#folder-hook .            set pgp_autoinline=no
folder-hook "!"$         set timeout=5
folder-hook <            set sort=reverse-date
folder-hook tnt@a-n-t_de unset crypt_autosign
# folder-hook lists        set sort=threads sort_aux=last-date-received
# folder-hook lists        set sort=threads sort_aux=date-sent
folder-hook lists        my_hdr From: Jan Larres <lists@majutsushi.net>
# folder-hook lists        my_hdr Reply-To: Jan Larres <jan@majutsushi.net>
# send-hook '~A'           my_hdr From: Jan Larres <jan@majutsushi.net>
# send-hook '~t uni-passau\.de$' 'my_hdr From: Jan Larres <larres@fim.uni-passau.de>'

# }}}
###############################################################################
# Mailing lists {{{

## "lists" adds a list of mailing lists addresses
## so mutt knows about these for showing them in the folder index
## and to allow replying to them with the command "list-reply".
## The first part of the address (up to the @) should be used here.
unlists *
lists `cd ~/Maildir && echo .lists.* | sed 's/_/\./g' | sed 's/\.lists\.//g'`

unsubscribe *
subscribe `cd ~/Maildir && echo .lists.* | sed 's/_/\./g' | sed 's/\.lists\.//g'`

# }}}
###############################################################################
# Obsolete stuff {{{

# obsoleted by imap_check_subscribed
## "mailboxes" defines the list of folders to be checked for new mail
## Mutt both can show the number of mailboxes with new mail in the index and
## you can cycle through these after giving the "change-folder" command.  :-)
# mailboxes !
# mailboxes !.DomainBOX
# mailboxes !.Uni
# mailboxes !.ebay
# mailboxes !.livejournal
# mailboxes !.login
# mailboxes !.privat
# mailboxes !.sent
# mailboxes !.shopping
# mailboxes !.wordpress
# mailboxes `for file in ~/Maildir/.lists.*; do echo -n "!$(basename $file) "; done`
# mailboxes `for file in ~/Maildir/.news.*; do echo -n "!$(basename $file) "; done`
# mailboxes `for file in ~/Maildir/.misc.*; do echo -n "!$(basename $file) "; done`

# }}}
###############################################################################

# vim: tw=0 fdm=marker fen

