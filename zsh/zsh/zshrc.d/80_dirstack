# make cd push the old directory onto the directory stack.
setopt auto_pushd

# Don't push multiple copies of the same directory onto the directory stack.
setopt pushd_ignore_dups

# Exchanges  the meanings of `+' and `-' when used with a number to specify a
# directory in the stack.
setopt pushd_minus

# Do not print the directory stack after pushd or popd.
setopt pushd_silent

DIRSTACKSIZE=20

if [[ -f $XDG_CACHE_HOME/zsh/zdirs ]] && [[ ${#dirstack[*]} -eq 0 ]]; then
    dirstack=( ${(uf)"$(< $XDG_CACHE_HOME/zsh/zdirs)"} )
    # "cd -" won't work after login by just setting $OLDPWD, so
    if [[ -d $dirstack[0] ]]; then
        cd $dirstack[0] && cd $OLDPWD
    fi
fi

chpwd() {
    builtin dirs -pl >! $XDG_CACHE_HOME/zsh/zdirs
}

# vim: filetype=zsh
