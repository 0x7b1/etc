[user]
	name = Jan Larres
	email = jan@majutsushi.net

[core]
	fsyncobjectfiles = false
	autocrlf = input

[alias]
	st = status
	ci = commit
	co = checkout

	ls  = log --stat
	lg  = log --graph --oneline --decorate
	lga = log --graph --oneline --decorate --all
	ll  = log --graph --pretty=tformat:\"%C(auto,yellow)%h %C(auto,blue)%ai%C(auto,green) %an %C(auto)%d %Creset%s\"
	lla = log --graph --pretty=tformat:\"%C(auto,yellow)%h %C(auto,blue)%ai%C(auto,green) %an %C(auto)%d %Creset%s\" --all
	log-refs = log --all --graph --decorate --oneline --simplify-by-decoration --no-merges
	show-upstream-branch = rev-parse --abbrev-ref '@{upstream}'
	show-push-branch = rev-parse --abbrev-ref '@{push}'
	in = "!if git-config --get-regexp svn-remote >/dev/null 2>&1; then if ! git ll ..trunk 2>/dev/null; then git ll ..git-svn; fi; else git ll ..@{upstream}; fi"
	new = "!f() { git ll ${1:-HEAD}@{1}..${1:-HEAD}@{0}; }; f"
	out = "!if git-config --get-regexp svn-remote >/dev/null 2>&1; then if ! git ll trunk.. 2>/dev/null; then git ll git-svn..; fi; else git ll @{push}..; fi"

	svnl = svn log --oneline --show-commit
	svn-show = "!f() { git show $(git svn find-rev $1); }; f"
	svn-co = "!f() { git checkout $(git svn find-rev $1); }; f"

	d  = diff -B -C -b
	sd = diff -B -C -b --staged
	wd = diff --color-words -B -C -b
	icdiff = "!f() { git difftool --no-prompt --extcmd icdiff \"$@\" | less -R; }; f"
	ws = show --color-words
	branch-diff = !git diff $(git merge-base HEAD master) $1
	bclean = "!f() { git branch --merged ${1:-master} | grep -v " ${1:-master}$" | xargs -r git branch -d; }; f"

	up = !git pull && git ll HEAD@{1}..
	reup = !git pull --rebase && git diff --stat HEAD@{1}.. && git ll HEAD@{1}..

	spull = "!f() { git pull \"$@\" && git submodule sync --recursive && git submodule update --init --recursive; }; f"
	spush = push --recurse-submodules=on-demand

	assume   = update-index --assume-unchanged
	unassume = update-index --no-assume-unchanged
	assumed  = "!git ls-files -v | grep ^h | cut -c 3-"
	snapshot = !git stash save "snapshot: $(date)" && git stash apply "stash@{0}"

	undo-commit = reset --soft HEAD^
	; from http://www.die-welt.net/2011/12/git-rocks-even-when-it-sucks/
	ls-big-files = "!for commit in $(git log --all --pretty=tformat:%H); do git ls-tree -r -l $commit; done |awk '{print $4 \" \" $5}' |sort -nur | head -n 10"
	purge-file = "!f() { [ -z \"$1\" ] && echo \"usage: git purge-file <file>\" && return; echo -n \"WARNING: Dangerous operation! Really purge file from history? [y/N] \"; read ans; [ \"$ans\" = \"y\" ] && git filter-branch -f --prune-empty --index-filter \"git rm -r --cached --ignore-unmatch \\\"$1\\\"\" -- --all; }; f"
	; from https://gist.github.com/492227
	lost = "!git fsck | awk '/dangling commit/ {print $3}' | git show --format='SHA1: %C(auto,yellow)%h%Creset %C(auto,blue)%ai%Creset %f' --stdin | awk '/^SHA1/ {sub(\"SHA1: \", \"\"); print}'"

[color]
	ui = auto

[color "diff"]
	meta = white bold
	frag = yellow
	func = cyan
	old  = red
	new  = green

[status]
	submoduleSummary = true

[diff]
	tool = vimdiff
	algorithm = histogram
	submodule = log

[branch]
	autosetuprebase = always

[pull]
	rebase = preserve

[push]
	default = simple
	recurseSubmodules = on-demand

[fetch]
	recurseSubmodules = on-demand
	prune = true

[tag]
	sort = version:refname

[log]
	date = local
	follow = true
	decorate = short

[mergetool "gvimdiff3"]
	cmd = gvim -f -d -c \"wincmd J\" \"$MERGED\" \"$LOCAL\" \"$BASE\" \"$REMOTE\"
[mergetool "vimdiff3"]
	cmd = vim -f -d -c \"wincmd J\" \"$MERGED\" \"$LOCAL\" \"$BASE\" \"$REMOTE\"
[mergetool "fugitive"]
	cmd = vim -f -c \"Gdiff\" \"$MERGED\"
[mergetool "splice"]
	cmd = "vim -f $BASE $LOCAL $REMOTE $MERGED -c 'SpliceInit'"
	trustExitCode = true

[merge]
	tool = splice
	conflictstyle = diff3
	ff = false

[rebase]
	autostash = true

[rerere]
	enabled = true
	autoupdate = true

[stash]
	showPatch = true
	showStat = true

[svn]
	rmdir = true

[tig]
	main-view = "id date:local author:width=15 commit-title:graph=yes,refs=yes,overflow=no"
	blame-options = "-C -C -C"
	horizontal-scroll = 50%
	ignore-space = "all"
	line-graphics = "utf-8"
	show-changes = yes
	split-view-height = 66%
	status-untracked-dirs = no
	tab-size = 8
	vertical-split = "false"

[tig "bind"]
	generic = y !@sh -c 'echo -n %(commit) | xclip -i -selection clipboard'
	generic = Y !@sh -c 'git svn find-rev %(commit) | tr -d [:cntrl:] | xclip -i -selection clipboard'

[tig "color"]
; General
	default     = default  default
	cursor      = default  color241
	status      = green    default
	title-focus = color16  white
	title-blur  = color241 white
	delimiter   = magenta  default
	line-number = cyan     default
	id          = yellow   default
	date        = blue     default
	author      = green    default
	mode        = cyan     default
; Main view
	graph-commit = blue default
	; palette-0    = magenta default
	; palette-1    = yellow default
	; palette-2    = blue default
	; palette-3    = green default
	; palette-4    = cyan default
	; palette-5    = white default
	; palette-6    = black default
; Tree view
	directory = yellow default bold
; Diff view
	diff-header = white  default bold
	diff-chunk  = yellow default

[web]
	browser = firefox

[instaweb]
	httpd = webrick

[gui]
	fontdiff = -family terminus -size 9 -weight normal -slant roman -underline 0 -overstrike 0

[url "ssh://[login]@git.gnome.org/git/"]
	insteadof = gnome:

[include]
	path = ~/.local/etc/gitconfig

# vim: filetype=gitconfig noexpandtab sw=8 sts=8
